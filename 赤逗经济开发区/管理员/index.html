<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ¤é€—ç»æµå¼€å‘åŒº Â· ç®¡ç†åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #1d444f;
            font-family: 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .login-card {
            background: white;
            border-radius: 48px;
            padding: 3rem 2.5rem;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        .login-icon {
            background: #125f6b;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto 1.5rem;
            color: white;
            box-shadow: 0 8px 0 #073d45;
        }
        .login-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #0d4d59;
            margin-bottom: 0.5rem;
        }
        .password-hint {
            background: #fef3dd;
            border-radius: 40px;
            padding: 1.5rem;
            margin: 2rem 0;
            border: 2px dashed #e5a823;
        }
        .password-hint code {
            background: #125f6b;
            color: white;
            padding: 0.3rem 1.5rem;
            border-radius: 60px;
            font-size: 1.5rem;
            letter-spacing: 8px;
            display: inline-block;
            margin-top: 0.8rem;
        }
        .input-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
        }
        .pwd-field {
            background: #f0f8fb;
            border: 3px solid #bcdbe3;
            border-radius: 60px;
            padding: 1rem 1.5rem;
            font-size: 1.2rem;
            width: 260px;
            text-align: center;
            letter-spacing: 8px;
            font-family: monospace;
        }
        .btn-login {
            background: #1b879a;
            border: none;
            border-bottom: 5px solid #0f5e6b;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            padding: 1rem 2.5rem;
            border-radius: 60px;
            cursor: pointer;
        }
        .admin-panel {
            background: white;
            border-radius: 48px;
            padding: 2rem;
            max-width: 1400px;
            width: 100%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-bottom: 2rem;
            border-bottom: 3px solid #ffc107;
            padding-bottom: 1rem;
        }
        .folder-structure {
            background: #f0f8fb;
            border-radius: 20px;
            padding: 1rem;
            margin-bottom: 2rem;
            font-family: monospace;
            font-size: 0.95rem;
        }
        .tab-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .tab-btn {
            padding: 0.8rem 2rem;
            border: none;
            background: #e0edf2;
            border-radius: 40px;
            font-weight: 600;
            color: #1d5a64;
            cursor: pointer;
        }
        .tab-btn.active {
            background: #1b879a;
            color: white;
        }
        .table-wrapper {
            overflow-x: auto;
            border-radius: 20px;
            background: #f3fafd;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        th {
            background: #1b879a;
            color: white;
            padding: 1rem;
        }
        td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #cae0e6;
            text-align: center;
        }
        .record-number {
            background: #ffc107;
            color: #0b3b44;
            padding: 0.2rem 0.8rem;
            border-radius: 30px;
            font-weight: 700;
        }
        .folder-badge {
            background: #125f6b;
            color: white;
            padding: 0.2rem 0.8rem;
            border-radius: 30px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div id="loginContainer" class="login-card">
        <div class="login-icon">ğŸ”</div>
        <div class="login-title">ç®¡ç†å‘˜éªŒè¯</div>
        <div class="password-hint">
            <div>è¯·è¾“å…¥6ä¸ªç©ºæ ¼ä½œä¸ºå¯†ç </div>
            <code>â£â£â£â£â£â£</code>
        </div>
        <div class="input-group">
            <input type="password" id="adminPwd" class="pwd-field" maxlength="6">
            <button id="loginBtn" class="btn-login">è¿›å…¥</button>
        </div>
        <div id="loginError" style="color: #b33; margin-top: 1rem;"></div>
    </div>

    <div id="adminPanel" class="admin-panel" style="display: none;">
        <div class="panel-header">
            <h2 style="color:#0d4d59;">ğŸ“‹ å…¥ç½‘è®°å½•ç®¡ç†</h2>
            <button id="logoutBtn" style="padding:0.5rem 2rem;">é€€å‡º</button>
        </div>

        <div class="folder-structure">
            <strong>ğŸ“ æœåŠ¡å™¨å­˜å‚¨ç»“æ„ï¼š</strong><br>
            &nbsp;&nbsp;ğŸ“‚ ç®¡ç†å‘˜/<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ğŸ“‚ è®°å½•/<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“„ å…¨éƒ¨è®°å½•.txt (æ‰€æœ‰ç”¨æˆ·æ±‡æ€»)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“‚ æ¬¡è®°å½•/<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“„ 1.txt (ç¬¬1ä¸ªç”¨æˆ·)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“„ 2.txt (ç¬¬2ä¸ªç”¨æˆ·)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ“„ 3.txt (ç¬¬3ä¸ªç”¨æˆ·)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...
        </div>

        <div class="tab-buttons">
            <button id="tabAllBtn" class="tab-btn active">ğŸ“„ å…¨éƒ¨è®°å½•</button>
            <button id="tabSubBtn" class="tab-btn">ğŸ“‚ æ¬¡è®°å½•åˆ—è¡¨</button>
        </div>

        <div id="allRecordsView">
            <div class="table-wrapper" id="allTableContainer">
                <!-- åŠ¨æ€æ¸²æŸ“ -->
            </div>
        </div>

        <div id="subRecordsView" style="display: none;">
            <div class="table-wrapper" id="subTableContainer">
                <!-- åŠ¨æ€æ¸²æŸ“ -->
            </div>
        </div>
    </div>

    <script>
        (function() {
            const ADMIN_PASSWORD = '      ';
            
            document.getElementById('loginBtn').addEventListener('click', function() {
                if (document.getElementById('adminPwd').value === ADMIN_PASSWORD) {
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    renderAllRecords();
                } else {
                    document.getElementById('loginError').innerText = 'âŒ å¯†ç é”™è¯¯ (6ä¸ªç©ºæ ¼)';
                }
            });

            document.getElementById('logoutBtn').addEventListener('click', function() {
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('loginContainer').style.display = 'block';
                document.getElementById('adminPwd').value = '';
            });

            // åˆ‡æ¢æ ‡ç­¾
            document.getElementById('tabAllBtn').addEventListener('click', function() {
                document.getElementById('tabAllBtn').classList.add('active');
                document.getElementById('tabSubBtn').classList.remove('active');
                document.getElementById('allRecordsView').style.display = 'block';
                document.getElementById('subRecordsView').style.display = 'none';
                renderAllRecords();
            });

            document.getElementById('tabSubBtn').addEventListener('click', function() {
                document.getElementById('tabSubBtn').classList.add('active');
                document.getElementById('tabAllBtn').classList.remove('active');
                document.getElementById('subRecordsView').style.display = 'block';
                document.getElementById('allRecordsView').style.display = 'none';
                renderSubRecords();
            });

            function renderAllRecords() {
                const allRecords = JSON.parse(localStorage.getItem('chidou_all_records') || '[]');
                const container = document.getElementById('allTableContainer');
                
                if (allRecords.length === 0) {
                    container.innerHTML = '<div style="padding:3rem; text-align:center;">ğŸ“­ æš‚æ— è®°å½•</div>';
                    return;
                }

                let html = `<table>
                    <thead>
                        <tr>
                            <th>ç¼–å·</th>
                            <th>å…¥ç½‘æ—¶é—´</th>
                            <th>æ‰‹æœºå·</th>
                            <th>å§“å</th>
                            <th>å•ä½</th>
                            <th>è®¾å¤‡ç±»å‹</th>
                            <th>IPåœ°å€</th>
                            <th>MACåœ°å€</th>
                            <th>æ¬¡è®°å½•æ–‡ä»¶</th>
                        </tr>
                    </thead>
                    <tbody>`;

                allRecords.sort((a, b) => b.recordNumber - a.recordNumber).forEach(rec => {
                    html += `<tr>
                        <td><span class="record-number">#${rec.recordNumber}</span></td>
                        <td>${rec.time || ''}</td>
                        <td>${rec.phone || ''}</td>
                        <td>${rec.name || ''}</td>
                        <td>${rec.affiliation || ''}</td>
                        <td>${rec.deviceType || ''}</td>
                        <td>${rec.ip || ''}</td>
                        <td><code>${rec.mac || ''}</code></td>
                        <td><span class="folder-badge">æ¬¡è®°å½•/${rec.recordNumber}.txt</span></td>
                    </tr>`;
                });

                html += `</tbody></table>`;
                container.innerHTML = html;
            }

            function renderSubRecords() {
                const maxNumber = parseInt(localStorage.getItem('chidou_max_record_number') || '0');
                const container = document.getElementById('subTableContainer');
                
                if (maxNumber === 0) {
                    container.innerHTML = '<div style="padding:3rem; text-align:center;">ğŸ“­ æš‚æ— æ¬¡è®°å½•</div>';
                    return;
                }

                let html = `<table>
                    <thead>
                        <tr>
                            <th>æ–‡ä»¶ç¼–å·</th>
                            <th>æ–‡ä»¶å</th>
                            <th>æ–‡ä»¶è·¯å¾„</th>
                            <th>åŒ…å«è®°å½•</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>`;

                for (let i = 1; i <= maxNumber; i++) {
                    const record = JSON.parse(localStorage.getItem(`chidou_sub_record_${i}`) || 'null');
                    html += `<tr>
                        <td><span class="record-number">#${i}</span></td>
                        <td>${i}.txt</td>
                        <td><code>ç®¡ç†å‘˜/è®°å½•/æ¬¡è®°å½•/${i}.txt</code></td>
                        <td>${record ? `ğŸ“± ${record.phone} (${record.name})` : 'âŒ è®°å½•ç¼ºå¤±'}</td>
                        <td><button onclick="viewSubRecord(${i})" style="padding:0.3rem 1rem;">æŸ¥çœ‹</button></td>
                    </tr>`;
                }

                html += `</tbody></table>`;
                container.innerHTML = html;
            }

            window.viewSubRecord = function(number) {
                const record = JSON.parse(localStorage.getItem(`chidou_sub_record_${number}`));
                if (!record) {
                    alert('è®°å½•ä¸å­˜åœ¨');
                    return;
                }

                // ç”Ÿæˆæ˜¾ç¤ºå†…å®¹
                let content = `ğŸ“ æ¬¡è®°å½•æ–‡ä»¶: ${number}.txt\n`;
                content += '='.repeat(40) + '\n';
                content += `å…¥ç½‘æ—¶é—´: ${record.time}\n`;
                content += `æ‰‹æœºå·ç : ${record.phone}\n`;
                content += `ç”¨æˆ·å§“å: ${record.name}\n`;
                content += `æ‰€å±å•ä½: ${record.affiliation}\n`;
                content += `è®¾å¤‡ç±»å‹: ${record.deviceType}\n`;
                content += `IPåœ°å€: ${record.ip}\n`;
                content += `MACåœ°å€: ${record.mac}\n`;

                alert(content);
            };
        })();
    </script>
</body>
</html>