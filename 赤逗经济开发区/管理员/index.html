<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ¤é€—ç»æµå¼€å‘åŒº Â· ç®¡ç†å‘˜ç»ˆç«¯</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #1a3e46;
            font-family: 'Segoe UI', Roboto, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }
        .admin-wrap {
            max-width: 1500px;
            width: 100%;
            background: #ecf0f3;
            border-radius: 40px;
            padding: 2.2rem;
            box-shadow: 0 20px 30px rgba(0,0,0,0.5);
        }
        .login-area {
            background: white;
            border-radius: 28px;
            padding: 2.5rem;
            text-align: center;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.02);
        }
        .login-title {
            font-size: 2.2rem;
            color: #0b4e5c;
            font-weight: 700;
            margin-bottom: 0.8rem;
        }
        .password-hint {
            background: #fef0d9;
            padding: 1rem;
            border-radius: 60px;
            color: #7d5a2a;
            font-size: 1.2rem;
            margin: 2rem 0;
            border: 2px dashed #b38f4a;
        }
        .password-input {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        .pwd-field {
            background: #f0f7fa;
            border: 3px solid #bfd8e0;
            border-radius: 60px;
            padding: 1rem 1.8rem;
            font-size: 1.3rem;
            width: 300px;
            text-align: center;
            letter-spacing: 6px;
            font-family: monospace;
        }
        .pwd-field:focus {
            border-color: #0e7e8c;
            outline: none;
            box-shadow: 0 0 0 4px rgba(15,126,140,0.3);
        }
        .btn {
            background: #1f8a9c;
            border: none;
            border-bottom: 5px solid #0e525e;
            color: white;
            font-weight: bold;
            padding: 1rem 2.5rem;
            border-radius: 60px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.1s;
        }
        .btn:active {
            border-bottom-width: 2px;
            transform: translateY(3px);
        }
        .btn-secondary {
            background: #476b6f;
            border-bottom-color: #2d4649;
        }
        .records-area {
            background: white;
            border-radius: 28px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 8px 0 #a0bcc2;
        }
        .area-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 1.8rem;
            border-bottom: 3px solid #7ab3c0;
            padding-bottom: 0.7rem;
        }
        .area-header h2 {
            color: #0b4e5c;
            font-size: 1.8rem;
        }
        .badge {
            background: #1d6b6f;
            color: white;
            padding: 0.4rem 1.4rem;
            border-radius: 50px;
            font-weight: 600;
        }
        .table-responsive {
            overflow-x: auto;
            border-radius: 18px;
            margin-bottom: 1.2rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 16px;
            font-size: 0.9rem;
        }
        th {
            background: #1e6a75;
            color: white;
            padding: 0.9rem 0.4rem;
            font-weight: 600;
            white-space: nowrap;
        }
        td {
            padding: 0.8rem 0.4rem;
            border-bottom: 1px solid #cde3e7;
            text-align: center;
            word-break: break-word;
        }
        .mac-badge {
            background: #2e6270;
            color: white;
            padding: 0.2rem 0.7rem;
            border-radius: 30px;
            font-family: monospace;
            font-size: 0.8rem;
            display: inline-block;
        }
        .device-tag {
            background: #3a6e8c;
            color: white;
            padding: 0.2rem 0.8rem;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        .null-msg {
            padding: 3rem;
            text-align: center;
            color: #5b7e84;
            font-size: 1.2rem;
        }
        .footer-note {
            margin-top: 1.5rem;
            color: #2d5a61;
            font-size: 0.85rem;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="admin-wrap">
        <!-- ç™»å½•ç•Œé¢ -->
        <div id="loginPanel" class="login-area">
            <div class="login-title">ğŸ” ç®¡ç†å‘˜æ§åˆ¶å°</div>
            <div class="password-hint">
                âš ï¸ è¯·è¾“å…¥6ä¸ªç©ºæ ¼ä½œä¸ºå¯†ç <br>
                <span style="font-size:2rem; letter-spacing:12px;">â£â£â£â£â£â£</span>
            </div>
            <div class="password-input">
                <input type="password" id="adminPwd" class="pwd-field" placeholder="å…­ä¸ªç©ºæ ¼" maxlength="6" autocomplete="off">
                <button id="loginBtn" class="btn">è¿›å…¥ç³»ç»Ÿ</button>
            </div>
            <div id="loginError" style="color: #b33; margin-top: 1.5rem; min-height: 2rem; font-size: 1.1rem;"></div>
        </div>

        <!-- è®°å½•é¢æ¿ï¼ˆåªè¯»ï¼Œæ— ä»»ä½•åˆ é™¤åŠŸèƒ½ï¼‰ -->
        <div id="recordsPanel" style="display: none;">
            <div class="records-area">
                <div class="area-header">
                    <h2>ğŸ“‹ å†å²å…¥ç½‘è®°å½•ï¼ˆåªè¯»ï¼‰</h2>
                    <span class="badge">æ€»æ¡æ•°: <span id="recordCount">0</span></span>
                </div>
                <div class="table-responsive" id="tableContainer">
                    <!-- JSåŠ¨æ€æ¸²æŸ“ -->
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 1rem; margin-top: 1.5rem;">
                    <button id="logoutBtn" class="btn btn-secondary">â¬…ï¸ é€€å‡ºç™»å½•</button>
                </div>
                <div class="footer-note">
                    * æ‰€æœ‰æ•°æ®æ¥æºäºæœ¬åœ°å­˜å‚¨ï¼ˆæ¨¡æ‹Ÿç›¸å¯¹ç›®å½•ï¼‰ï¼Œç®¡ç†å‘˜ä»…å¯æŸ¥çœ‹ï¼Œä¸å¯åˆ é™¤/ä¿®æ”¹ã€‚
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            const STORAGE_KEY = 'chidou_network_records';
            const ADMIN_PASSWORD = '      '; // 6ä¸ªç©ºæ ¼

            const loginPanel = document.getElementById('loginPanel');
            const recordsPanel = document.getElementById('recordsPanel');
            const pwdInput = document.getElementById('adminPwd');
            const loginBtn = document.getElementById('loginBtn');
            const loginError = document.getElementById('loginError');
            const logoutBtn = document.getElementById('logoutBtn');
            const recordCountSpan = document.getElementById('recordCount');
            const tableContainer = document.getElementById('tableContainer');

            // è·å–è®°å½•
            function getRecords() {
                const data = localStorage.getItem(STORAGE_KEY);
                return data ? JSON.parse(data) : [];
            }

            // æ¸²æŸ“è¡¨æ ¼ï¼ˆçº¯å±•ç¤ºï¼Œæ— ä»»ä½•åˆ é™¤/ç¼–è¾‘æŒ‰é’®ï¼‰
            function renderRecords() {
                const records = getRecords();
                recordCountSpan.innerText = records.length;

                if (records.length === 0) {
                    tableContainer.innerHTML = `<div class="null-msg">ğŸ“­ æš‚æ— ä»»ä½•è¿æ¥è®°å½•</div>`;
                    return;
                }

                // æŒ‰æ—¶é—´å€’åºï¼ˆæœ€æ–°çš„åœ¨ä¸Šï¼‰
                const sorted = [...records].sort((a, b) => (a.time < b.time ? 1 : -1));

                let html = `<table>
                    <thead>
                        <tr>
                            <th>æ‰‹æœºå·</th>
                            <th>æ‰€å±å…³ç³»</th>
                            <th>åŸå› </th>
                            <th>IPåœ°å€</th>
                            <th>MACåœ°å€</th>
                            <th>è®¾å¤‡ç±»å‹</th>
                            <th>è¿æ¥æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody>`;

                sorted.forEach(rec => {
                    html += `<tr>
                        <td>${escapeHtml(rec.phone || '')}</td>
                        <td>${escapeHtml(rec.affiliation || '')}</td>
                        <td>${escapeHtml(rec.reason || '')}</td>
                        <td style="font-weight:600; color:#0e5e6b;">${escapeHtml(rec.ip || '')}</td>
                        <td><span class="mac-badge">${escapeHtml(rec.mac || '')}</span></td>
                        <td><span class="device-tag">${escapeHtml(rec.device || 'æœªçŸ¥')}</span></td>
                        <td>${escapeHtml(rec.time || '')}</td>
                    </tr>`;
                });

                html += `</tbody></table>`;
                tableContainer.innerHTML = html;
            }

            function escapeHtml(unsafe) {
                if (!unsafe) return '';
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }

            // ç™»å½•éªŒè¯
            function doLogin() {
                const pwd = pwdInput.value;
                if (pwd === ADMIN_PASSWORD) {
                    loginPanel.style.display = 'none';
                    recordsPanel.style.display = 'block';
                    renderRecords();
                    loginError.innerText = '';
                } else {
                    loginError.innerText = 'âŒ å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼ˆ6ä¸ªç©ºæ ¼ï¼‰';
                    pwdInput.value = '';
                    pwdInput.focus();
                }
            }

            loginBtn.addEventListener('click', doLogin);
            pwdInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    doLogin();
                }
            });

            // é€€å‡ºç™»å½•
            logoutBtn.addEventListener('click', () => {
                recordsPanel.style.display = 'none';
                loginPanel.style.display = 'block';
                pwdInput.value = '';
                loginError.innerText = '';
            });
        })();
    </script>
</body>
</html>